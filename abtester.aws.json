{
    "services": [
        {
            "id": "simulator",
            "source_repository": "https://github.com/newrelic/demo-simulator.git",
            "deploy_script_path": "deploy/linux/roles",
            "port": 6003,
            "destinations": [
                "host2"
            ],
            "files": [
                {
                    "destination_filepath": "engine/startScenario.json",
                    "content": [
                        {
                            "id": "unsubscriptionTraffic",
                            "rpm": 10,
                            "steps": [
                                {
                                    "name": "httpPostJson",
                                    "params": [
                                        "[service:abtester]/unsubscribe",
                                        {}
                                    ]
                                }
                            ]
                        },
                        {
                            "id": "subscriptionTraffic",
                            "rpm": 30,
                            "steps": [
                                {
                                    "name": "browserStart",
                                    "params": []
                                },
                                {
                                    "name": "browserGoto",
                                    "params": [
                                        "[service:abtester]"
                                    ]
                                },
                                {
                                    "name": "browserClick",
                                    "params": [
                                        "#subscribeBtn"
                                    ]
                                },
                                {
                                    "name": "sleepMs",
                                    "params": [
                                        "1000"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "id": "abtester",
            "display_name": "Newsletter",
            "local_source_path": "/mnt/demotron/demo-nodetron",
            "deploy_script_path": "deploy/linux/roles",
            "port": 5001,
            "destinations": [
                "host1"
            ],
            "params": {
              "a_unsub_rate": 30,
              "b_unsub_rate": 70,
              "auth_string": "Bearer ABC123",
              "rollover_threshold": 1000
            }
        }
    ],
    "global_tags": {
        "dxOwningTeam": "DemoX",
        "dxEnvironment": "development",
        "dxDepartment": "Area51",
        "dxProduct": "ABTester"
    },
    "resources": [
        {
            "id": "host1",
            "display_name": "abtest-Host1",
            "provider": "aws",
            "type": "ec2",
            "size": "t3.micro"
        },
        {
            "id": "host2",
            "display_name": "abtest-simHost2",
            "provider": "aws",
            "type": "ec2",
            "size": "t3.micro"
        }
 
    ],
    "instrumentations": {
        "resources": [
            {
                "id": "nr_infra",
                "resource_ids": [
                    "host1",
                    "host2"
                ],
                "provider": "newrelic",
                "source_repository": "https://github.com/newrelic/demo-newrelic-instrumentation.git",
                "deploy_script_path": "deploy/linux/roles",
                "version": "1.12.1"
            }
        ],
        "services": [
            {
                "id": "nr_node_agent",
                "service_ids": [
                    "abtester"
                ],
                "provider": "newrelic",
                "source_repository": "https://github.com/newrelic/demo-newrelic-instrumentation.git",
                "deploy_script_path": "deploy/node/linux/roles",
                "version": "6.11.0"
            }
        ]
    }
}
